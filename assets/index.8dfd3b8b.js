var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;function*a(e,t){const n=[...e],o=n.length;if(void 0===t&&(t=o),t>o)return;let r,l=[...Array(o).keys()],i=[];for(r=o;r>o-t;--r)i.push(r);for(yield l.slice(0,t).map((e=>n[e]));r>=0;)for(r=t-1;r>=0;--r){if(--i[r],0!=i[r]){const e=o-i[r],a=l[r];l[r]=l[e],l[e]=a,yield l.slice(0,t).map((e=>n[e]));break}l.push(...l.splice(r,1)),i[r]=o-r}}function*u(e,t){const n=[...Array(e).keys()];for(const o of function*(e,t){const n=[...e];void 0===t&&(t=n.length);const o=n.length;if(t>o)return;let r=[...Array(t).keys()];for(yield r.map((e=>n[e]));;){let e=t-1;for(;e>=0&&r[e]===e+o-t;--e);if(e<0)return;++r[e];for(let n=e+1;n<t;++n)r[n]=r[n-1]+1;yield r.map((e=>n[e]))}}(n,t)){const[e,...t]=n.filter((e=>-1===o.indexOf(e)));for(const n of a(o))for(const o of a(t)){let t=[],r=[e,...o];for(let e=0;e<r.length;++e)t.push([...n,...r]),r.push(r.shift());yield t}}}const s=["#F0A3FF","#0075DC","#993F00","#4C005C","#191919","#005C31","#2BCE48","#FFCC99","#808080","#94FFB5","#8F7C00","#9DCC00","#C20088","#003380","#FFA405","#FFA8BB","#426600","#FF0010","#5EF1F2","#00998F","#E0FF66","#740AFF","#990000","#FFFF80","#FFFF00","#FF5005"];function d(e,t){return Array.from(e).map((e=>t[parseInt(e)])).join("")}function c(e,a){return e.map((e=>{var u,s,c=e,{label:p}=c,V=((e,t)=>{var n={};for(var i in e)r.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&o)for(var i of o(e))t.indexOf(i)<0&&l.call(e,i)&&(n[i]=e[i]);return n})(c,["label"]);return u=((e,t)=>{for(var n in t||(t={}))r.call(t,n)&&i(e,n,t[n]);if(o)for(var n of o(t))l.call(t,n)&&i(e,n,t[n]);return e})({},V),s={label:d(p,a)},t(u,n(s))}))}var p=Vue.defineComponent({setup:()=>{const e={nodes:new vis.DataSet([]),edges:new vis.DataSet([])};let t;const n=Vue.ref(),o=Vue.ref("2,3"),r=Vue.ref(!0),l=Vue.ref(5),i=Vue.ref("01234"),a=Vue.ref(1),p=Vue.ref("000000100000100000100010000010000010000010010001000001000001000002100000100000100000100000210000010000010000010001001000001000001000001000100000100000100"),V=Vue.ref(""),f=Vue.computed((()=>{let e=new Set;for(let t=l.value;t<=V.value.length;t++){const n=V.value.slice(t-l.value,t);new Set(n).size===l.value&&e.add(n)}return e.size})),h=Vue.ref([0,1,2,3]);let v=l.value;const g=()=>{let{nodes:n,edges:f,decoded:g,state:y}=function(e,t,n,o,r){n|=0;let l=new Map,i=new Map,a=0;for(let v=0;v<e-1;++v)for(let t of u(e,v)){for(let e=0;e<t.length;++e){const u=(e+1)%t.length,d=t[e].join(""),c=t[u].join("");i.set(d+c,{id:d+c,from:d,to:c,title:d+"→"+c+" rank "+v,color:s[v%s.length],width:.1,physics:o,smooth:!1,hidden:r.includes(v)}),v===n&&l.set(d,{id:d,label:d,borderWidth:0,opacity:.5,color:s[a%s.length],mass:1,dashes:!1,shape:"ellipse",shadow:!1})}v===n&&++a}let d=[...Array(e).keys()],c=[...d],p=[],V=new Set,f="";for(let u=0;u<t.length;++u){const n=t[u];d.push(...d.splice(n,1));let o=i.get(c.join("")+d.join(""));if(void 0===o)return{nodes:[],edges:[],decoded:"no rank "+n+"edges",state:d};o.width=6,o.length=100,o.title+=" ord "+u,o.physics=!0,o.hidden=!1;let r=l.get(d.join(""));if(void 0===r)return{nodes:[],edges:[],decoded:"node "+c.join("")+" not found",state:d};r.borderWidth=2,p.length==e&&p.shift(),p.push(d[e-1]),new Set(p).size===e&&(r.opacity=.8,V.has(p.join(""))?r.shape="database":(V.add(p.join("")),r.shape="circle")),r.mass=1,c=[...d],f+=d[e-1]}let h=l.get(d.join(""));return console.log(h),h.borderWidth=3,h.mass=2,h.shadow=!0,{nodes:Array.from(l.values()),edges:Array.from(i.values()),decoded:f,state:d}}(l.value,Array.from(p.value).map((e=>parseInt(e))),a.value,!r.value,o.value.split(",").map((e=>parseInt(e)))),m=i.value.split("");m.length!==l.value&&(m=[...Array(l.value).keys()]),n=c(n,m),V.value=d(g,m),h.value=y,v!==l.value&&(e.nodes.clear(),e.edges.clear(),v=l.value),t.storePositions(),e.nodes.update(n),e.edges.update(f)};Vue.watch([l,p,a,r,o,i],g);const y=Vue.ref(""),m=({edges:t})=>{var n;1===t.length?y.value=null==(n=e.edges.get(t[0]))?void 0:n.title:y.value=""};return Vue.onMounted((()=>{t=new vis.Network(n.value,e,{autoResize:!0,edges:{arrows:{to:{enabled:!0}}},height:"800",configure:{filter:"physics"}}),t.on("click",m),g()})),{data:e,n:l,netDiv:n,encoding:p,sequence:V,permCount:f,internalState:h,highlightRank:a,hideRanks:o,traceOnly:r,initState:i,info:y}}});const V=Vue.createTextVNode("n="),f=Vue.createTextVNode("initial state:"),h=Vue.createTextVNode("highlight rank:"),v=Vue.createTextVNode("hide ranks:"),g=Vue.createTextVNode("trace-only physics:"),y={class:"network",ref:"netDiv"};p.render=function(e,t,n,o,r,l){return Vue.openBlock(),Vue.createBlock(Vue.Fragment,null,[Vue.createVNode("div",null,[V,Vue.withDirectives(Vue.createVNode("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.n=t),type:"number"},null,512),[[Vue.vModelText,e.n,void 0,{number:!0}]]),f,Vue.withDirectives(Vue.createVNode("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.initState=t),type:"string"},null,512),[[Vue.vModelText,e.initState,void 0,{string:!0}]]),h,Vue.withDirectives(Vue.createVNode("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.highlightRank=t),type:"number"},null,512),[[Vue.vModelText,e.highlightRank,void 0,{number:!0}]]),v,Vue.withDirectives(Vue.createVNode("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.hideRanks=t),type:"string"},null,512),[[Vue.vModelText,e.hideRanks,void 0,{sting:!0}]]),g,Vue.withDirectives(Vue.createVNode("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.traceOnly=t),type:"checkbox"},null,512),[[Vue.vModelCheckbox,e.traceOnly,void 0,{boolean:!0}]])]),Vue.createVNode("div",null,[Vue.withDirectives(Vue.createVNode("textarea",{class:"enc","onUpdate:modelValue":t[6]||(t[6]=t=>e.encoding=t),type:"string"},null,512),[[Vue.vModelText,e.encoding,void 0,{string:!0}]])]),Vue.createVNode("div",null,Vue.toDisplayString(e.sequence||" "),1),Vue.createVNode("div",null,"unique permutation count: "+Vue.toDisplayString(e.permCount)+" length: "+Vue.toDisplayString(e.sequence.length)+" encoder state: "+Vue.toDisplayString(e.internalState.join("")),1),Vue.createVNode("div",null,Vue.toDisplayString(e.info||" "),1),Vue.createVNode("div",y,null,512)],64)},Vue.createApp(p).mount("#app");
